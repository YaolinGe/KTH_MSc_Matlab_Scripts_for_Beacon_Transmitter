function y = LP(x, FIR)
%% y = LP(x, FIRorIIR)
%% low pass filter the input data using FIR if 1 or IIR 0
if FIR
    % FIR filter
%     b = [0.055476737624970982876160263685960671864
%         0.05770493704786346100821248228385229595
%         0.059067867586184194528264868040423607454
%         0.059526559119447014500892123578523751348
%         0.059067867586184194528264868040423607454
%         0.05770493704786346100821248228385229595
%         0.055476737624970982876160263685960671864];
%     b = b';
%     a = 1;
    N = 6;
    Fs = 160e3;
    fs = 5;
    fp = 6;
    f = [0 fs fp Fs]/Fs;
    a = [1 1 0 0];
    [b,a] = firls(N, f, a);

else
%     LP IIR filter;
%     SOS = [1  -1.958839842556389321259757707593962550163  1  1  -1.95999965565488576402231046813540160656   0.965267484967275102292205701814964413643
%         1  -1.923872505839867574906065783579833805561  1  1  -1.896880935941323231830324402835685759783  0.902304458312001234077115441323257982731
%         1  -1.494023840911112843699015684251207858324  1  1  -1.854935741025906414947144185134675353765  0.860600847140936653367759845423279330134];
%     [b, a] = sos2tf(SOS);
SOS = [1,-1.94083102810768,1,1,-1.95085531856416,0.958431618132387;1,-1.89098571823222,1,1,-1.87606226569591,0.883813333556214;1,-1.30818352680357,1,1,-1.82684536829437,0.834907923509496];
[b, a] = sos2tf(SOS);
end %if

y= filter(b, a, x);

end %LP
